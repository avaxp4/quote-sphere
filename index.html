<!DOCTYPE html>
<html lang="ar" dir="rtl" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manara - منارة الحكمة</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400&family=Cairo:wght@400;600;700&family=Reem+Kufi:wght@400;500;600;700&family=Tajawal:wght@400;500;700&family=Scheherazade+New:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        amber: {
                            50: '#fffbeb',
                            100: '#fef3c7',
                        },
                        stone: {
                            800: '#292524',
                            900: '#1c1917',
                        }
                    },
                    fontFamily: {
                        cairo: ['Cairo', 'sans-serif'],
                        amiri: ['Amiri', 'serif'],
                        reem: ['Reem Kufi', 'sans-serif'],
                        tajawal: ['Tajawal', 'sans-serif'],
                        scheherazade: ['Scheherazade New', 'serif'],
                    }
                }
            }
        }
    </script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Vue.js -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body class="bg-amber-50 dark:bg-stone-900 text-stone-800 dark:text-stone-300 font-cairo min-h-screen flex flex-col transition-colors duration-300">

    <div id="app" class="flex-grow flex flex-col">
        
        <!-- Navigation Bar -->
        <nav class="bg-white/90 dark:bg-stone-800/90 backdrop-blur-sm shadow-md sticky top-0 z-50 border-b border-stone-200 dark:border-stone-700 transition-colors duration-300">
            <div class="container mx-auto px-4">
                <div class="flex justify-between items-center h-16">
                    <!-- Logo -->
                    <a href="#/" class="flex items-center gap-2 cursor-pointer group">
                        <i class="fas fa-lightbulb text-amber-600 dark:text-amber-500 text-2xl group-hover:text-amber-700 dark:group-hover:text-amber-400 transition-colors"></i>
                        <span class="text-2xl font-bold text-stone-800 dark:text-stone-100 font-reem">منارة</span>
                    </a>

                    <!-- Tabs (Desktop) -->
                    <div class="hidden md:flex gap-2">
                        <a 
                            v-for="tab in tabs" 
                            :key="tab.id"
                            :href="'#/' + (tab.id === 'home' ? '' : tab.id)"
                            :class="['px-4 py-2 rounded-md transition-all font-semibold border border-transparent', 
                                activeTab === tab.id 
                                ? 'bg-amber-50 dark:bg-stone-700 text-amber-700 dark:text-amber-400 border-amber-200 dark:border-stone-600 shadow-sm' 
                                : 'text-stone-600 dark:text-stone-400 hover:bg-stone-50 dark:hover:bg-stone-700 hover:text-stone-900 dark:hover:text-stone-200']"
                        >
                            {{ tab.label }}
                        </a>
                    </div>

                    <!-- Controls -->
                    <div class="flex items-center gap-4">
                        <!-- Dark Mode Toggle -->
                        <button @click="toggleDarkMode" class="w-10 h-10 rounded-full flex items-center justify-center bg-stone-100 dark:bg-stone-700 text-stone-600 dark:text-amber-400 hover:bg-stone-200 dark:hover:bg-stone-600 transition-colors focus:outline-none">
                            <i :class="['fas', isDarkMode ? 'fa-moon' : 'fa-sun']"></i>
                        </button>

                        <!-- Mobile Menu Button -->
                        <button class="md:hidden text-stone-600 dark:text-stone-300" @click="mobileMenuOpen = !mobileMenuOpen">
                            <i class="fas fa-bars text-xl"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Mobile Menu -->
            <div v-if="mobileMenuOpen" class="md:hidden bg-white dark:bg-stone-800 border-t border-stone-100 dark:border-stone-700">
                <div class="flex flex-col p-2">
                    <a 
                        v-for="tab in tabs" 
                        :key="tab.id"
                        :href="'#/' + (tab.id === 'home' ? '' : tab.id)"
                        @click="mobileMenuOpen = false"
                        :class="['px-4 py-3 rounded-md text-right transition-colors font-semibold', activeTab === tab.id ? 'bg-amber-50 dark:bg-stone-700 text-amber-700 dark:text-amber-400' : 'text-stone-600 dark:text-stone-400 hover:bg-stone-50 dark:hover:bg-stone-700']"
                    >
                        {{ tab.label }}
                    </a>
                </div>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="container mx-auto px-4 py-8 flex-grow">
            
            <!-- Tag Filters (Only for Quotes & Poetry) -->
            <div v-if="(activeTab === 'quotes' || activeTab === 'poetry') && !loading && !error" class="mb-8 overflow-x-auto pb-2 scrollbar-hide">
                <div class="flex gap-2 min-w-max px-1">
                    <button 
                        @click="filterByTag(null)"
                        :class="['px-4 py-1.5 rounded-full text-sm font-bold transition-all border', 
                            !activeTag 
                            ? 'bg-amber-700 dark:bg-amber-600 text-white border-amber-700 dark:border-amber-600 shadow-md' 
                            : 'bg-white dark:bg-stone-800 text-stone-600 dark:text-stone-400 border-stone-300 dark:border-stone-600 hover:border-amber-500 dark:hover:border-amber-500']"
                    >
                        الكل
                    </button>
                    <button 
                        v-for="tag in uniqueTags" 
                        :key="tag"
                        @click="filterByTag(tag)"
                        :class="['px-4 py-1.5 rounded-full text-sm font-bold transition-all border', 
                            activeTag === tag 
                            ? 'bg-amber-700 dark:bg-amber-600 text-white border-amber-700 dark:border-amber-600 shadow-md' 
                            : 'bg-white dark:bg-stone-800 text-stone-600 dark:text-stone-400 border-stone-300 dark:border-stone-600 hover:border-amber-500 dark:hover:border-amber-500']"
                    >
                        {{ tag }}
                    </button>
                </div>
            </div>

            <!-- Loading State -->
            <div v-if="loading" class="flex justify-center items-center py-20">
                <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-amber-700 dark:border-amber-500"></div>
            </div>

            <!-- Error State -->
            <div v-else-if="error" class="text-center py-10 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg max-w-2xl mx-auto">
                <i class="fas fa-exclamation-circle text-4xl text-red-500 dark:text-red-400 mb-4"></i>
                <p class="text-red-700 dark:text-red-300 text-lg">{{ error }}</p>
                <button @click="retryFetch" class="mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition">
                    حاول مرة أخرى
                </button>
            </div>

            <!-- Views -->
            <div v-else>
                
                <!-- Home View -->
                <div v-if="activeTab === 'home'" class="animate-fade-in">
                    <header class="text-center py-20 bg-white dark:bg-stone-800 rounded-2xl shadow-md border border-stone-200 dark:border-stone-700 mb-12 hero-pattern relative overflow-hidden transition-colors duration-300">
                        <div class="relative z-10 px-4">
                            <h1 class="text-5xl md:text-7xl font-reem font-bold text-amber-900 dark:text-amber-500 mb-6 drop-shadow-sm">منارة الحكمة</h1>
                            <p class="text-xl md:text-2xl text-stone-600 dark:text-stone-300 max-w-2xl mx-auto leading-relaxed font-amiri">
                                "الحكمة ضالة المؤمن، أنى وجدها فهو أحق بها"
                            </p>
                            <div class="mt-10 flex flex-col sm:flex-row justify-center gap-4">
                                <a href="#/quotes" class="px-8 py-3 bg-amber-700 dark:bg-amber-600 text-white rounded-full hover:bg-amber-800 dark:hover:bg-amber-700 transition shadow-lg font-bold text-lg">
                                    تصفح الأقوال
                                </a>
                                <a href="#/poetry" class="px-8 py-3 bg-transparent text-amber-700 dark:text-amber-500 border-2 border-amber-700 dark:border-amber-500 rounded-full hover:bg-amber-50 dark:hover:bg-stone-700 transition shadow-sm font-bold text-lg">
                                    روائع الشعر
                                </a>
                            </div>
                        </div>
                    </header>
                    
                    <!-- Featured Sections -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <a href="#/quotes" class="bg-orange-50/50 dark:bg-stone-800 p-8 rounded-xl shadow-md border border-stone-300 dark:border-stone-700 hover:shadow-xl hover:-translate-y-1 transition-all duration-300 group">
                            <div class="w-14 h-14 bg-amber-100 dark:bg-stone-700 rounded-full flex items-center justify-center text-amber-700 dark:text-amber-500 mb-6 group-hover:scale-110 transition-transform shadow-inner">
                                <i class="fas fa-quote-right text-2xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold mb-3 text-stone-800 dark:text-stone-100 font-reem">أقوال مأثورة</h3>
                            <p class="text-stone-600 dark:text-stone-400 leading-relaxed">كنوز من الحكمة والفلسفة الخالدة عبر العصور.</p>
                        </a>
                        <a href="#/poetry" class="bg-orange-50/50 dark:bg-stone-800 p-8 rounded-xl shadow-md border border-stone-300 dark:border-stone-700 hover:shadow-xl hover:-translate-y-1 transition-all duration-300 group">
                            <div class="w-14 h-14 bg-amber-100 dark:bg-stone-700 rounded-full flex items-center justify-center text-amber-700 dark:text-amber-500 mb-6 group-hover:scale-110 transition-transform shadow-inner">
                                <i class="fas fa-feather-alt text-2xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold mb-3 text-stone-800 dark:text-stone-100 font-reem">شعر عربي</h3>
                            <p class="text-stone-600 dark:text-stone-400 leading-relaxed">أبيات مختارة من عيون الشعر العربي وفصاحته.</p>
                        </a>
                        <a href="#/figures" class="bg-orange-50/50 dark:bg-stone-800 p-8 rounded-xl shadow-md border border-stone-300 dark:border-stone-700 hover:shadow-xl hover:-translate-y-1 transition-all duration-300 group">
                            <div class="w-14 h-14 bg-amber-100 dark:bg-stone-700 rounded-full flex items-center justify-center text-amber-700 dark:text-amber-500 mb-6 group-hover:scale-110 transition-transform shadow-inner">
                                <i class="fas fa-users text-2xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold mb-3 text-stone-800 dark:text-stone-100 font-reem">شخصيات تاريخية</h3>
                            <p class="text-stone-600 dark:text-stone-400 leading-relaxed">سير العظماء الذين شكلوا الفكر الإنساني.</p>
                        </a>
                    </div>
                </div>

                <!-- Quotes View -->
                <div v-if="activeTab === 'quotes'" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in">
                    <div v-for="item in filteredItems" :key="item.id" class="quote-card bg-orange-50/50 dark:bg-stone-800 rounded-xl shadow-md border border-stone-300 dark:border-stone-700 p-6 flex flex-col relative overflow-hidden group hover:shadow-lg transition-all duration-300">
                        <!-- Original Text (if exists) -->
                        <div v-if="item.original_text" class="mb-4 pb-4 border-b border-stone-200 dark:border-stone-700">
                            <p class="text-stone-500 dark:text-stone-400 font-serif italic text-sm mb-1 text-left" dir="ltr">{{ item.original_text }}</p>
                            <span class="text-[10px] uppercase tracking-wider text-stone-500 dark:text-stone-400 bg-stone-100 dark:bg-stone-700 px-2 py-0.5 rounded inline-block">{{ item.original_language }}</span>
                        </div>
                        
                        <!-- Main Text -->
                        <div class="flex-grow mb-6">
                            <p class="text-xl md:text-2xl font-bold text-stone-800 dark:text-stone-200 leading-relaxed font-cairo">
                                "{{ item.text_content }}"
                            </p>
                        </div>

                        <!-- Historical Context -->
                        <div v-if="item.historical_context" class="mb-4 p-3 bg-amber-100/40 dark:bg-stone-700/50 rounded-lg border border-amber-200/50 dark:border-stone-600">
                            <p class="text-xs text-stone-700 dark:text-stone-400 leading-relaxed font-tajawal">
                                <i class="fas fa-info-circle text-amber-600 dark:text-amber-500 ml-1"></i>
                                {{ item.historical_context }}
                            </p>
                        </div>

                        <!-- Footer -->
                        <div class="mt-auto flex justify-between items-end">
                            <div>
                                <a :href="'#/author/' + item.author?.id" class="font-bold text-amber-800 dark:text-amber-500 text-sm hover:underline font-reem">
                                    {{ item.author?.name }}
                                </a>
                                <div class="flex gap-1 mt-2 flex-wrap">
                                    <span v-for="tag in item.tags" :key="tag" class="text-[10px] text-stone-600 dark:text-stone-400 bg-stone-200 dark:bg-stone-700 px-2 py-0.5 rounded-full">#{{ tag }}</span>
                                </div>
                            </div>
                            <button @click="copyText(item.text_content)" class="text-stone-400 hover:text-amber-600 dark:hover:text-amber-400 transition-colors" title="نسخ">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Poetry View -->
                <div v-if="activeTab === 'poetry'" class="max-w-3xl mx-auto space-y-8 animate-fade-in">
                    <div v-for="item in filteredItems" :key="item.id" class="poetry-card bg-orange-50/30 dark:bg-stone-800 rounded-2xl shadow-md border-double border-4 border-stone-200 dark:border-stone-700 p-10 text-center relative transition-colors duration-300">
                        <!-- Decorative Elements -->
                        <div class="absolute top-4 left-1/2 transform -translate-x-1/2 text-amber-200 dark:text-stone-700 text-4xl opacity-50">
                            <i class="fas fa-feather-alt"></i>
                        </div>

                        <!-- Poem Content -->
                        <div class="relative z-10 mb-8">
                            <p class="text-2xl md:text-3xl font-scheherazade leading-loose text-stone-800 dark:text-stone-200 poetry-text">
                                {{ formatPoetry(item.text_content) }}
                            </p>
                        </div>

                        <!-- Footer -->
                        <div class="border-t border-stone-200 dark:border-stone-700 pt-6 inline-block w-full">
                            <a :href="'#/author/' + item.author?.id" class="font-bold text-amber-800 dark:text-amber-500 text-lg mb-2 hover:underline font-reem block">
                                {{ item.author?.name }}
                            </a>
                            <div class="flex justify-center gap-2">
                                <span v-for="tag in item.tags" :key="tag" class="text-xs text-stone-500 dark:text-stone-400 bg-stone-100 dark:bg-stone-700 px-3 py-1 rounded-full border border-stone-200 dark:border-stone-600">{{ tag }}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Figures View -->
                <div v-if="activeTab === 'figures'" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in">
                    <div v-for="author in items" :key="author.id" class="bg-orange-50/50 dark:bg-stone-800 rounded-xl shadow-md border border-stone-300 dark:border-stone-700 overflow-hidden group hover:shadow-xl transition-all duration-300">
                        <div class="h-48 bg-stone-200 dark:bg-stone-700 relative overflow-hidden">
                            <img v-if="author.image_url" :src="author.image_url" :alt="author.name" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500 opacity-90 group-hover:opacity-100">
                            <div v-else class="w-full h-full flex items-center justify-center bg-stone-100 dark:bg-stone-700 text-stone-300 dark:text-stone-600">
                                <i class="fas fa-user text-6xl"></i>
                            </div>
                            <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4">
                                <span class="text-white text-xs bg-amber-700/90 px-2 py-1 rounded font-tajawal shadow-sm">{{ author.era }}</span>
                            </div>
                        </div>
                        <div class="p-6">
                            <h3 class="text-xl font-bold mb-2 text-stone-800 dark:text-stone-100 font-reem">{{ author.name }}</h3>
                            <p class="text-stone-600 dark:text-stone-400 text-sm mb-6 line-clamp-3 font-tajawal leading-relaxed">{{ author.bio }}</p>
                            <a :href="'#/author/' + author.id" class="block w-full py-2.5 border border-amber-600 dark:border-amber-500 text-amber-700 dark:text-amber-500 rounded-lg hover:bg-amber-50 dark:hover:bg-stone-700 transition font-bold text-sm text-center">
                                اقرأ المزيد
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Author Detail View -->
                <div v-if="activeTab === 'author_detail' && selectedAuthor" class="animate-fade-in">
                    <button @click="goBack" class="mb-6 flex items-center gap-2 text-stone-500 dark:text-stone-400 hover:text-amber-700 dark:hover:text-amber-500 transition font-bold">
                        <i class="fas fa-arrow-right"></i>
                        <span>عودة</span>
                    </button>

                    <!-- Author Header -->
                    <div class="bg-white dark:bg-stone-800 rounded-2xl shadow-md border border-stone-200 dark:border-stone-700 p-8 mb-8 flex flex-col md:flex-row gap-8 items-center md:items-start transition-colors duration-300">
                        <div class="w-32 h-32 md:w-48 md:h-48 rounded-full overflow-hidden border-4 border-stone-100 dark:border-stone-600 flex-shrink-0 shadow-lg">
                            <img v-if="selectedAuthor.image_url" :src="selectedAuthor.image_url" :alt="selectedAuthor.name" class="w-full h-full object-cover">
                            <div v-else class="w-full h-full flex items-center justify-center bg-stone-100 dark:bg-stone-700 text-stone-300 dark:text-stone-500">
                                <i class="fas fa-user text-4xl"></i>
                            </div>
                        </div>
                        <div class="text-center md:text-right flex-grow">
                            <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-4">
                                <h2 class="text-3xl md:text-4xl font-bold text-stone-800 dark:text-stone-100 font-reem">{{ selectedAuthor.name }}</h2>
                                <span class="inline-block mt-2 md:mt-0 px-4 py-1.5 bg-amber-100 dark:bg-stone-700 text-amber-800 dark:text-amber-400 rounded-full text-sm font-bold shadow-sm">{{ selectedAuthor.era }}</span>
                            </div>
                            <p class="text-stone-600 dark:text-stone-300 leading-loose text-lg font-tajawal">{{ selectedAuthor.bio }}</p>
                        </div>
                    </div>

                    <!-- Author Content -->
                    <h3 class="text-2xl font-bold mb-6 text-stone-800 dark:text-stone-200 border-b-2 border-amber-200 dark:border-stone-700 pb-2 inline-block font-reem">الأعمال والمأثورات</h3>
                    
                    <div class="grid grid-cols-1 gap-6">
                        <div v-for="item in selectedAuthorContents" :key="item.id" class="bg-orange-50/30 dark:bg-stone-800 rounded-xl shadow-sm border border-stone-200 dark:border-stone-700 p-8 hover:shadow-md transition-all duration-300">
                            <div v-if="item.type === 'poem'" class="text-center">
                                <p class="text-2xl font-scheherazade leading-loose whitespace-pre-line text-stone-800 dark:text-stone-200 poetry-text">{{ formatPoetry(item.text_content) }}</p>
                            </div>
                            <div v-else>
                                <p class="text-xl font-bold text-stone-800 dark:text-stone-200 mb-3 font-cairo">"{{ item.text_content }}"</p>
                                <p v-if="item.original_text" class="text-sm text-stone-500 dark:text-stone-400 font-serif italic" dir="ltr">{{ item.original_text }}</p>
                            </div>
                            <div class="mt-6 flex gap-2 justify-center md:justify-start border-t border-stone-100 dark:border-stone-700 pt-4">
                                <span v-for="tag in item.tags" :key="tag" class="text-xs text-stone-500 dark:text-stone-400 bg-stone-100 dark:bg-stone-700 px-2 py-1 rounded">#{{ tag }}</span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </main>

        <!-- Developer Footer -->
        <footer class="bg-white dark:bg-stone-800 border-t border-stone-200 dark:border-stone-700 py-6 text-center transition-colors duration-300">
            <div class="container mx-auto px-4">
                <p class="text-stone-500 dark:text-stone-400 text-sm font-tajawal mb-2">
                    Developed by <span class="font-bold text-amber-700 dark:text-amber-500">Abdulrahman Abdulkareem | Avax43</span>
                </p>
                <div class="flex justify-center gap-4 mt-2">
                    <a href="https://wa.me/+201093216167" class="text-stone-400 hover:text-green-600 transition-colors text-lg" title="WhatsApp">
                        <i class="fab fa-whatsapp"></i>
                    </a>
                    <a href="https://t.me/avax43" class="text-stone-400 hover:text-blue-500 transition-colors text-lg" title="Telegram">
                        <i class="fab fa-telegram"></i>
                    </a>

                </div>
                <p class="text-xs text-stone-300 dark:text-stone-600 mt-4">
                    &copy; 2025 QuoteSphere
                </p>
            </div>
        </footer>
    </div>

    <script src="js/app.js"></script>
</body>
</html>
